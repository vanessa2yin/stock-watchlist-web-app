{
  "version": 3,
  "file": "bundle.css",
  "sources": [
    "../src/App.svelte"
  ],
  "sourcesContent": [
    "<script>\n\timport { onMount } from 'svelte';\n\n\t// data stored\n\tlet watchlist_map = [\n\t\t{\n\t\t\t'name':'Default',\n\t\t\t'stockList': [{ value: 'AAPL' }, { value: 'MSFT' }, { value: 'SPX' }]\n\t\t},\n\t\t{\n\t\t\t'name':'Second',\n\t\t\t'stockList': [{ value: 'MSFT' }, { value: 'SPX' }]\n\t\t},\n\t\t{\n\t\t\t'name':'Third',\n\t\t\t'stockList': [{ value: 'SPX' }]\n\t\t},\n\t];\n\n\tlet defaultStockList = [{ value: 'AAPL' }, { value: 'MSFT' }, { value: 'SPX' }];\n\n\n\t// data displayed\n\tlet watchlistName = 'Default';\n\tlet stockList = [{ value: 'AAPL' }, { value: 'MSFT' }, { value: 'SPX' }];\n\tlet symbolToAdd = '';\n\tlet autocomplete_result = [];\n\t\n\tonMount(() => {\n\t\tinitWatchlistTable();\n\t});\n\n\tfunction initWatchlistTable() {\n\t\tconsole.log('init...');\n\t\tfetchAllStockDescription();\n\t\tfetchAllPrices();\n\t}\n\n\t// may be removed\n\tfunction clearSymbol(symbol) {\n\t\tlet position = symbol.indexOf('/');\n\t\tif (position > -1) {\n\t\t\tsymbol = symbol.replace('/', '');\n\t\t}\n\t\tposition = symbol.indexOf(':');\n\t\tif (position > -1) {\n\t\t\tsymbol = symbol.substr(0, position);\n\t\t}\n\t\treturn symbol;\n\t}\n\n\tfunction updateStockListStored(newStockList) {\n\t\tfor (let i = 0; i < watchlist_map; i++) {\n\t\t\tif (watchlist_map[i].name === watchlistName) {\n\t\t\t\twatchlist_map[i].stockList = newStockList;\n\t\t\t}\n\t\t}\n\t}\n\n\tasync function fetchStockDescription(symbol) {\n\t\tconst URL = 'https://api.tastyworks.com/symbols/search/' + symbol;\n\t\treturn fetch(URL)\n\t\t\t.then(res => res.json())\n\t\t\t.then(res => {\n\t\t\t\treturn res.data.items[0].description;\n\t\t\t});\n\t}\n\n\tfunction fetchAllStockDescription() {\n\t\tconsole.log('fetch description..');\n\t\tfor (let i = 0; i < stockList.length; i++) {\n\t\t\tlet symbol = clearSymbol(stockList[i].value);\n\t\t\tlet description = fetchStockDescription(symbol)\n\t\t\t\t.then(des => {\n\t\t\t\t\tstockList[i].description = des;\n\t\t\t\t});\n\t\t}\n\t}\n\n\tasync function fetchPricesForStockAt(index) {\n\t\tlet symbol = clearSymbol(stockList[index].value);\n\t\tlet res = dxFeed.getQuote(symbol);\n\t\tstockList[index].askPrice = res.ask;\n\t\tstockList[index].bidPrice = res.bid;\n\t\tstockList[index].lastPrice = res.last;\n\t}\n\n\tfunction fetchAllPrices() {\n\t\tfor (let i = 0; i < stockList.length; i++) {\n\t\t\tfetchPricesForStockAt(i);\n\t\t}\n\t}\n\n\tfunction handleDeleteSymbol(event, index) {\n\t\tstockList.splice(index, 1);\n\t\tfetchAllPrices(); //update immediately\n\t}\n\n\tfunction handleAddSymbol(event, symbol) {\n\t\tstockList.push({\n\t\t\tvalue: symbol\n\t\t});\n\t\tfetchStockDescription(symbol)\n\t\t\t.then(des => {\n\t\t\t\tstockList[stockList.length-1].description = des;\n\t\t\t});\n\t\tsymbolToAdd = '';\n\t}\n\n\tfunction fetchSymbolsForAutoComplete() {\n\t\tif (symbolToAdd.length == 0) {\n\t\t\tautocomplete_result = [];\n\t\t\treturn;\n\t\t}\n\t\tconst URL = 'https://api.tastyworks.com/symbols/search/' + symbolToAdd.toUpperCase();\n\t\treturn fetch(URL)\n\t\t\t.then(res => res.json())\n\t\t\t.then(res => {\n\t\t\t\tlet result = [];\n\t\t\t\tlet items = res.data.items;\n\t\t\t\tfor (let i = 0; i < items.length; i++) {\n\t\t\t\t\tresult.push(items[i].symbol + \": \" + items[i].description);\n\t\t\t\t}\n\t\t\t\tautocomplete_result = result;\n\t\t\t\tconsole.log(autocomplete_result);\n\t\t\t});\n\t}\n\n\tfunction handleChangeWatchList(event, newWatchlist) {\n\t\tif (watchlistName === newWatchlist.name) {\n\t\t\treturn;\n\t\t}\n\t\tconsole.log('Store data... ');\n\t\tupdateStockListStored(stockList);\n\t\t\n\t\tconsole.log('Switch to ' + newWatchlist.name)\n\t\twatchlistName = newWatchlist.name;\n\t\tstockList = newWatchlist.stockList;\n\t\tinitWatchlistTable();\n\t}\n\n\tfunction handleAddNewWatchlist(event) {\n\t\tlet newWatchlist = {\n\t\t\t'name':'new watch list',\n\t\t\t'stockList': defaultStockList\n\t\t};\n\t\twatchlist_map.push(newWatchlist);\n\t\twatchlist_map = watchlist_map;\n\t\thandleChangeWatchList(null, newWatchlist);\n\t}\n\n\tfunction handleDeleteWatchList(event, index) {\n\t\twatchlist_map.splice(index, 1);\n\t\twatchlist_map = watchlist_map;\n\t}\n\n\tsetInterval(fetchAllPrices, 2000);\n\tsetInterval(fetchSymbolsForAutoComplete, 2000);\n\n</script>\n\n<style>\nh1 {\n\ttext-align: center;\n}\n\ntable {\n\tfont-weight: lighter;\n\tborder-collapse: collapse;\n\tbackground-color: rgb(34,34,34);\n\twidth: 80%;\n\tmargin: 0 auto;\n}\n\nth {\n\ttext-align: center;\n\tcolor: white;\n\tpadding: 8px;\n\theight: 40px;\n}\ntd {\n\tborder-top: 1px solid grey;\n\tcolor: white;\n\ttext-align: center;\n\tpadding: 8px;\n}\n\n.description {\n\twidth: 300px;\n\toverflow: hidden;\n}\n\n.bidPrice .askPrice .lastPrice {\n\twidth: 150px;\n\toverflow: hidden;\n}\n\n.tableButtons {\n\tbackground-color: transparent;\n\tborder: none;\n\tcolor: white;\n\twidth: 40px;\n}\n\n.tableButtons:hover {\n\tbackground-color: white;\n\tborder: none;\n\tcolor: black;\n\twidth: 40px;\n}\n\n.navBar {\n  list-style-type: none;\n  margin: 0;\n  padding: 0;\n  width: 200px;\n  background-color: #f1f1f1;\n\n  height: 100%;\n  position: fixed;\n  z-index: 1;\n  top: 0;\n  left: 0;\n  overflow-x: hidden;\n  padding-top: 20px;\n}\n\n.navBarButton {\n\twidth: 200px;\n\tborder: none;\n\tdisplay: block;\n\tbackground-color: #f1f1f1;\n\tcolor: #000;\n\tpadding: 8px 16px;\n\ttext-decoration: none;\n}\n\n.navBarButton:hover {\n\tbackground-color: #555;\n\tcolor: white;\n}\n\n.main {\n\tmargin-left: 200px;\n}\n\n</style>\n\n<!-- <button on:click={e => fetchSymbols(e, \"s\")}>\n\ttest\n</button> -->\n<ul class=\"navBar\">\n\t{#each watchlist_map as watchlist, idx}\n\t\t<li>\n\t\t\t<button class=\"navBarButton\" on:click={e => {handleChangeWatchList(e, watchlist)}}>{watchlist.name}</button>\n\t\t\t<button class=\"navBarDeleteButton\" on:click={e => handleDeleteWatchList(e, idx)}> ✘ </button>\n\t\t</li>\n\t{/each}\n\t<li><button class=\"navBarButton\" on:click={e => {handleAddNewWatchlist(e)}}> + Add new watchlist </button></li>\n</ul>\n<div class=\"main\">\n\t<h1> {watchlistName} Watchlist</h1>\n\n\t<table>\n\t\t<tr>\n\t\t\t<th class=\"symbol\">Symbol</th>\n\t\t\t<th class=\"description\">Description</th>\n\t\t\t<th class=\"bidPrice\">Bid Price</th>\n\t\t\t<th class=\"askPrice\">Ask Price</th>\n\t\t\t<th class=\"lastPrice\">Last Price</th>\n\t\t\t<th class=\"delete\">Delete</th>\n\t\t</tr>\n\t\t\n\t\t{#each stockList as stock, idx}\n\t\t<tr>\n\t\t\t<td>{stock.value}</td>\n\t\t\t<td>{stock.description || '-'}</td>\n\t\t\t<td>{stock.bidPrice || '-'}</td>\n\t\t\t<td>{stock.askPrice || '-'}</td>\n\t\t\t<td>{stock.lastPrice || '-'}</td>\n\t\t\t<td><button class=\"tableButtons\" on:click={e => handleDeleteSymbol(e, idx)}> ✘ </button></td>\n\t\t</tr>\n\t\t{/each}\n\t\t<tr>\n\t\t\t<td colspan=\"6\">\n\t\t\t\t<input placeholder=\"Add symbol\" bind:value={symbolToAdd} list=\"choices\">\n\t\t\t\t<datalist id=\"choices\">\n\t\t\t\t\t{#each autocomplete_result as choice}\n\t\t\t\t\t\t<option value={choice} />\n\t\t\t\t\t{/each}\n\t\t\t\t</datalist>\n\t\t\t\t<button class=\"tableButtons\" on:click={e => handleAddSymbol(e, clearSymbol(symbolToAdd))}> ✔︎ </button>\n\t\t\t</td> \n\t\t</tr>\n\t</table>\n</div>\n"
  ],
  "names": [],
  "mappings": "AAkKA,EAAE,cAAC,CAAC,AACH,UAAU,CAAE,MAAM,AACnB,CAAC,AAED,KAAK,cAAC,CAAC,AACN,WAAW,CAAE,OAAO,CACpB,eAAe,CAAE,QAAQ,CACzB,gBAAgB,CAAE,IAAI,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAC/B,KAAK,CAAE,GAAG,CACV,MAAM,CAAE,CAAC,CAAC,IAAI,AACf,CAAC,AAED,EAAE,cAAC,CAAC,AACH,UAAU,CAAE,MAAM,CAClB,KAAK,CAAE,KAAK,CACZ,OAAO,CAAE,GAAG,CACZ,MAAM,CAAE,IAAI,AACb,CAAC,AACD,EAAE,cAAC,CAAC,AACH,UAAU,CAAE,GAAG,CAAC,KAAK,CAAC,IAAI,CAC1B,KAAK,CAAE,KAAK,CACZ,UAAU,CAAE,MAAM,CAClB,OAAO,CAAE,GAAG,AACb,CAAC,AAED,YAAY,cAAC,CAAC,AACb,KAAK,CAAE,KAAK,CACZ,QAAQ,CAAE,MAAM,AACjB,CAAC,AAOD,aAAa,cAAC,CAAC,AACd,gBAAgB,CAAE,WAAW,CAC7B,MAAM,CAAE,IAAI,CACZ,KAAK,CAAE,KAAK,CACZ,KAAK,CAAE,IAAI,AACZ,CAAC,AAED,2BAAa,MAAM,AAAC,CAAC,AACpB,gBAAgB,CAAE,KAAK,CACvB,MAAM,CAAE,IAAI,CACZ,KAAK,CAAE,KAAK,CACZ,KAAK,CAAE,IAAI,AACZ,CAAC,AAED,OAAO,cAAC,CAAC,AACP,eAAe,CAAE,IAAI,CACrB,MAAM,CAAE,CAAC,CACT,OAAO,CAAE,CAAC,CACV,KAAK,CAAE,KAAK,CACZ,gBAAgB,CAAE,OAAO,CAEzB,MAAM,CAAE,IAAI,CACZ,QAAQ,CAAE,KAAK,CACf,OAAO,CAAE,CAAC,CACV,GAAG,CAAE,CAAC,CACN,IAAI,CAAE,CAAC,CACP,UAAU,CAAE,MAAM,CAClB,WAAW,CAAE,IAAI,AACnB,CAAC,AAED,aAAa,cAAC,CAAC,AACd,KAAK,CAAE,KAAK,CACZ,MAAM,CAAE,IAAI,CACZ,OAAO,CAAE,KAAK,CACd,gBAAgB,CAAE,OAAO,CACzB,KAAK,CAAE,IAAI,CACX,OAAO,CAAE,GAAG,CAAC,IAAI,CACjB,eAAe,CAAE,IAAI,AACtB,CAAC,AAED,2BAAa,MAAM,AAAC,CAAC,AACpB,gBAAgB,CAAE,IAAI,CACtB,KAAK,CAAE,KAAK,AACb,CAAC,AAED,KAAK,cAAC,CAAC,AACN,WAAW,CAAE,KAAK,AACnB,CAAC"
}